# Genetic Syndrome Classification with Embeddings

ğŸš€ **Projeto de Machine Learning** - ClassificaÃ§Ã£o de SÃ­ndromes GenÃ©ticas usando embeddings de imagens.

## ğŸ“– Sobre o Projeto

Este projeto foi desenvolvido como parte de um teste tÃ©cnico para uma vaga de **Desenvolvedor de Machine Learning**. O objetivo principal Ã© analisar embeddings extraÃ­dos de imagens e utilizÃ¡-los para **classificar sÃ­ndromes genÃ©ticas**.

Os embeddings sÃ£o **vetores de 320 dimensÃµes** gerados por um modelo prÃ©-treinado, e o desafio Ã© criar uma pipeline robusta para:

âœ” **PrÃ©-processamento dos dados**
âœ” **AnÃ¡lise exploratÃ³ria** (EDA)
âœ” **VisualizaÃ§Ã£o de dados com t-SNE**
âœ” **ClassificaÃ§Ã£o usando KNN**
âœ” **AvaliaÃ§Ã£o de mÃ©tricas manuais**
âœ” **InterpretaÃ§Ã£o e anÃ¡lise dos resultados**

---

## ğŸ“‚ Estrutura do Projeto

```bash
â”œâ”€â”€ data/                     # DiretÃ³rio de dados
â”‚   â”œâ”€â”€ mini_gm_public_v0.1.p # Arquivo original de embeddings (pickle)
â”‚   â”œâ”€â”€ preprocessed_data.csv # Dados processados para anÃ¡lise
â”‚   â”œâ”€â”€ outputs/              # Resultados do modelo
â”‚   â”‚   â”œâ”€â”€ models/           # (Reservado para modelos treinados, se necessÃ¡rio)
â”‚   â”‚   â”œâ”€â”€ plots/            # VisualizaÃ§Ãµes geradas pelo projeto
â”‚   â”‚   â”‚   â”œâ”€â”€ confusion_matrix_cosine.png
â”‚   â”‚   â”‚   â”œâ”€â”€ confusion_matrix_euclidean.png
â”‚   â”‚   â”‚   â”œâ”€â”€ knn_accuracy_cosine.png
â”‚   â”‚   â”‚   â”œâ”€â”€ knn_accuracy_euclidean.png
â”‚   â”‚   â”‚   â”œâ”€â”€ roc_curve_comparison.png
â”‚   â”‚   â”‚   â”œâ”€â”€ syndrome_distribution.png
â”‚   â”‚   â”‚   â”œâ”€â”€ tsne_cluster_density_heatmap.png
â”‚   â”‚   â”‚   â”œâ”€â”€ tsne_visualization.png
â”‚   â”‚   â”œâ”€â”€ tables/           # Tabelas de mÃ©tricas e relatÃ³rios de performance
â”‚   â”‚   â”‚   â”œâ”€â”€ classification_report_cosine.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ classification_report_euclidean.txt
â”‚   â”‚   â”‚   â”œâ”€â”€ knn_results_summary.csv
â”‚   â”‚   â”‚   â”œâ”€â”€ performance_metrics_summary.csv
â”œâ”€â”€ src/                      # CÃ³digo-fonte do projeto
â”‚   â”œâ”€â”€ data_processing.py     # Script para carregamento e prÃ©-processamento
â”‚   â”œâ”€â”€ eda_visualization.py   # AnÃ¡lise exploratÃ³ria e visualizaÃ§Ã£o de dados
â”‚   â”œâ”€â”€ KNN_Classification.py  # ImplementaÃ§Ã£o do KNN para classificaÃ§Ã£o
â”‚   â”œâ”€â”€ metrics_evaluation.py  # CÃ¡lculo e avaliaÃ§Ã£o de mÃ©tricas de performance
â”‚   â”œâ”€â”€ main.py                # Pipeline principal
â”œâ”€â”€ README.md                  # DocumentaÃ§Ã£o do projeto
â”œâ”€â”€ requirements.txt           # Bibliotecas necessÃ¡rias
â””â”€â”€ report.pdf                 # RelatÃ³rio tÃ©cnico final
```

---

## ğŸ“Š **Dataset**

O dataset Ã© fornecido no formato **pickle** (`mini_gm_public_v0.1.p`) e segue a estrutura hierÃ¡rquica:

```python
{
  'syndrome_id': {
    'subject_id': {
      'image_id': [320-dimensional embedding]
    }
  }
}
```

O dataset original **nÃ£o estÃ¡ incluÃ­do neste repositÃ³rio** por questÃµes de privacidade e direitos de uso.

ğŸ¯ **Objetivo** : Usar esses embeddings para classificar a sÃ­ndrome genÃ©tica associada a cada imagem.

ğŸ“Œ **PossÃ­vel erro ao carregar o arquivo** :

Se encontrar o erro `"numpy.core._multiarray_umath"`, atualize o NumPy com:

```bash
pip install --upgrade numpy
```

---

## **Pipeline do Projeto**

### ğŸ”¹ 1. PrÃ©-processamento dos Dados (`data_processing.py`)

- Carregamento e conversÃ£o dos embeddings do formato **pickle** para um **DataFrame**
- NormalizaÃ§Ã£o dos dados
- Tratamento de valores ausentes

### ğŸ”¹ 2. AnÃ¡lise ExploratÃ³ria e VisualizaÃ§Ã£o (`eda_visualization.py`)

- EstatÃ­sticas gerais: **quantidade de sÃ­ndromes, distribuiÃ§Ã£o de imagens por sÃ­ndrome**
- IdentificaÃ§Ã£o de **desbalanceamento de classes**
- GeraÃ§Ã£o dos grÃ¡ficos:
  - **`syndrome_distribution.png`** â†’ DistribuiÃ§Ã£o das sÃ­ndromes
  - **`tsne_visualization.png`** â†’ VisualizaÃ§Ã£o 2D dos embeddings com t-SNE
  - **`tsne_cluster_density_heatmap.png`** â†’ Heatmap de densidade dos clusters

### ğŸ”¹ 3. ClassificaÃ§Ã£o (`KNN_Classification.py`)

- ImplementaÃ§Ã£o do **K-Nearest Neighbors (KNN)**
- Uso das **mÃ©tricas de distÃ¢ncia Cosine e Euclidean**
- **10-Fold Cross-Validation** para encontrar o melhor `k` (1 a 15)
- GeraÃ§Ã£o dos grÃ¡ficos:
  - **`knn_accuracy_cosine.png`** e **`knn_accuracy_euclidean.png`** â†’ PrecisÃ£o do modelo
  - **`confusion_matrix_cosine.png`** e **`confusion_matrix_euclidean.png`** â†’ Matrizes de confusÃ£o

### ğŸ”¹ 4. AvaliaÃ§Ã£o de MÃ©tricas (`metrics_evaluation.py`)

- CÃ¡lculo das mÃ©tricas de performance:
  âœ” **Ãrea sob a curva ROC (AUC)**
  âœ” **F1-Score**
  âœ” **Top-k Accuracy**
- GeraÃ§Ã£o das **Curvas ROC** :
  - **`roc_curve_comparison.png`** â†’ ComparaÃ§Ã£o entre as mÃ©tricas de distÃ¢ncia
- RelatÃ³rios e tabelas geradas:
  - **classification_report_cosine.txt** e **classification_report_euclidean.txt**
  - **knn_results_summary.csv**
  - **performance_metrics_summary.csv**

## ğŸ“ˆ **Resultados**

âœ” A **visualizaÃ§Ã£o com t-SNE** revelou padrÃµes de agrupamento Ãºteis para classificaÃ§Ã£o.

âœ” O modelo **KNN** teve melhor desempenho com **k=5** usando **distÃ¢ncia Cosine** .

âœ” A mÃ©trica **AUC e F1-Score** indicaram boa separabilidade entre as classes.

âœ” A curva ROC mostrou diferenÃ§as entre as mÃ©tricas de distÃ¢ncia.

ğŸ“Œ **Insights principais** :

- A distÃ¢ncia **Cosine** obteve **melhor desempenho** do que a Euclidean.
- Algumas sÃ­ndromes possuem dados desbalanceados, impactando a classificaÃ§Ã£o.
- Melhorias futuras podem incluir **redes neurais e data augmentation** .

---

## ğŸ’» **Como Executar o Projeto**

### 1ï¸âƒ£ Clonar o repositÃ³rio:

```bash
git clone https://github.com/seu-usuario/genetic-syndrome-classification.git
cd genetic-syndrome-classification
```

### 2ï¸âƒ£ Instalar as dependÃªncias:

```bash
pip install -r requirements.txt
```

### 3ï¸âƒ£ Executar a pipeline completa:

```bash
python src/main.py
```

---

## ğŸ“„ **RelatÃ³rio**

Um relatÃ³rio tÃ©cnico completo sobre os resultados e interpretaÃ§Ãµes do modelo pode ser encontrado em **`report.pdf`** .

---

## ğŸ“¬ **Contato**

ğŸ“Œ Desenvolvido por **Henrique Baptista**

ğŸ“§ Email: [henriquebaptista2003@gmail.com](mailto:henriquebaptista2003@gmail.com)

ğŸ”— GitHub: [henriquebap](https://github.com/henriquebap)

[![LinkedIn](https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/henrique-baptista777/)

---
